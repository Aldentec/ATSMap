<Window x:Class="ProHauler.UI.Views.PerformanceWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="clr-namespace:ProHauler.UI.Converters"
        xmlns:behaviors="clr-namespace:ProHauler.UI.Behaviors"
        mc:Ignorable="d"
        Title="ProHauler - Performance Dashboard" 
        Height="700" Width="1000"
        MinHeight="600" MinWidth="900"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource WindowBackground}"
        SizeChanged="Window_SizeChanged">
    
    <Window.Resources>
        <converters:GradeToColorConverter x:Key="GradeToColorConverter" />
        <converters:ScoreToColorConverter x:Key="ScoreToColorConverter" />
        <converters:TrendToSymbolConverter x:Key="TrendToSymbolConverter" />
        <converters:TrendToColorConverter x:Key="TrendToColorConverter" />
        <converters:ConnectionStatusToColorConverter x:Key="ConnectionStatusToColorConverter" />
        <converters:ColorIndicatorToBrushConverter x:Key="ColorIndicatorToBrushConverter" />
        <converters:NotificationTypeToColorConverter x:Key="NotificationTypeToColorConverter" />
        <converters:NotificationAgeToOpacityConverter x:Key="NotificationAgeToOpacityConverter" />
        <converters:DamageToColorConverter x:Key="DamageToColorConverter" />
        
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        
        <!-- Rich Tooltip Template for Metrics -->
        <DataTemplate x:Key="MetricTooltipTemplate">
            <Border Background="#2C3E50" 
                    BorderBrush="#34495E" 
                    BorderThickness="1"
                    CornerRadius="8" 
                    Padding="15"
                    MaxWidth="400">
                <Border.Effect>
                    <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="5" 
                                      BlurRadius="20" Opacity="0.3" />
                </Border.Effect>
                
                <StackPanel>
                    <!-- Header with Icon and Name -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="{Binding Icon}" 
                                   FontSize="24" 
                                   VerticalAlignment="Center"
                                   Margin="0,0,10,0" />
                        <StackPanel>
                            <TextBlock Text="{Binding MetricName}" 
                                       FontSize="16" 
                                       FontWeight="Bold"
                                       Foreground="White" />
                            <TextBlock Foreground="#BDC3C7" FontSize="11">
                                <Run Text="Current: " />
                                <Run Text="{Binding CurrentValue, StringFormat={}{0:F1}%, Mode=OneWay}" 
                                     FontWeight="Bold" />
                                <Run Text=" | Weight: " />
                                <Run Text="{Binding Weight, StringFormat={}{0:F0}%, Mode=OneWay}" 
                                     FontWeight="Bold" />
                            </TextBlock>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Separator -->
                    <Border Height="1" Background="#34495E" Margin="0,5,0,10" />
                    
                    <!-- Calculation Explanation -->
                    <TextBlock Text="ðŸ“Š How It's Calculated" 
                               FontSize="13" 
                               FontWeight="SemiBold"
                               Foreground="#3498DB"
                               Margin="0,0,0,5" />
                    <TextBlock Text="{Binding CalculationExplanation}" 
                               FontSize="11"
                               Foreground="#ECF0F1"
                               TextWrapping="Wrap"
                               Margin="0,0,0,10"
                               LineHeight="16" />
                    
                    <!-- Current Penalties -->
                    <TextBlock Text="âš ï¸ Current Penalties" 
                               FontSize="13" 
                               FontWeight="SemiBold"
                               Foreground="#E74C3C"
                               Margin="0,0,0,5" />
                    <TextBlock Text="{Binding CurrentPenalties}" 
                               FontSize="11"
                               Foreground="#ECF0F1"
                               TextWrapping="Wrap"
                               Margin="0,0,0,10"
                               LineHeight="16" />
                    
                    <!-- Current Bonuses -->
                    <TextBlock Text="âœ¨ Current Bonuses" 
                               FontSize="13" 
                               FontWeight="SemiBold"
                               Foreground="#27AE60"
                               Margin="0,0,0,5" />
                    <TextBlock Text="{Binding CurrentBonuses}" 
                               FontSize="11"
                               Foreground="#ECF0F1"
                               TextWrapping="Wrap"
                               Margin="0,0,0,10"
                               LineHeight="16" />
                    
                    <!-- Separator -->
                    <Border Height="1" Background="#34495E" Margin="0,5,0,10" />
                    
                    <!-- Improvement Tips -->
                    <TextBlock Text="ðŸ’¡ Tips for Improvement" 
                               FontSize="13" 
                               FontWeight="SemiBold"
                               Foreground="#F39C12"
                               Margin="0,0,0,5" />
                    <TextBlock Text="{Binding ImprovementTips}" 
                               FontSize="11"
                               Foreground="#ECF0F1"
                               TextWrapping="Wrap"
                               LineHeight="16" />
                </StackPanel>
            </Border>
        </DataTemplate>
        
        <!-- Theme Colors - Light Theme (Default) -->
        <SolidColorBrush x:Key="WindowBackground" Color="#F5F7FA" />
        <SolidColorBrush x:Key="CardBackground" Color="#FFFFFF" />
        <SolidColorBrush x:Key="CardBorderBrush" Color="#E8ECEF" />
        <SolidColorBrush x:Key="PrimaryText" Color="#2C3E50" />
        <SolidColorBrush x:Key="SecondaryText" Color="#7F8C8D" />
        <SolidColorBrush x:Key="TertiaryText" Color="#95A5A6" />
        <SolidColorBrush x:Key="AccentColor" Color="#3498DB" />
        <SolidColorBrush x:Key="SuccessColor" Color="#27AE60" />
        <SolidColorBrush x:Key="WarningColor" Color="#F39C12" />
        <SolidColorBrush x:Key="DangerColor" Color="#E74C3C" />
        
        <!-- Fade In Animation -->
        <Storyboard x:Key="FadeInAnimation">
            <DoubleAnimation Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.5"
                           AccelerationRatio="0.3" />
        </Storyboard>
        
        <!-- Scale Up Animation -->
        <Storyboard x:Key="ScaleUpAnimation">
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                           From="0.95" To="1" Duration="0:0:0.3"
                           AccelerationRatio="0.2" />
            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                           From="0.95" To="1" Duration="0:0:0.3"
                           AccelerationRatio="0.2" />
        </Storyboard>
        
        <!-- Enhanced Metric Card Style with Gradient -->
        <Style x:Key="MetricCardStyle" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource CardBackground}" />
            <Setter Property="BorderBrush" Value="{DynamicResource CardBorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Margin" Value="8" />
            <Setter Property="Padding" Value="20" />
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="3" 
                                      BlurRadius="15" Opacity="0.08" />
                </Setter.Value>
            </Setter>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1" />
                </Setter.Value>
            </Setter>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5" />
            <Style.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard Storyboard="{StaticResource FadeInAnimation}" />
                </EventTrigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                               To="1.02" Duration="0:0:0.2" />
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                               To="1.02" Duration="0:0:0.2" />
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                               To="1" Duration="0:0:0.2" />
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                               To="1" Duration="0:0:0.2" />
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.ExitActions>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- Card Icon Style -->
        <Style x:Key="CardIconStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="36" />
            <Setter Property="HorizontalAlignment" Value="Center" />
            <Setter Property="Margin" Value="0,0,0,10" />
            <Setter Property="Opacity" Value="0.9" />
        </Style>
        
        <!-- Card Title Style -->
        <Style x:Key="CardTitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="{DynamicResource SecondaryText}" />
            <Setter Property="Margin" Value="0,0,0,8" />
            <Setter Property="HorizontalAlignment" Value="Center" />
        </Style>
        
        <!-- Card Value Style with Animation -->
        <Style x:Key="CardValueStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="42" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="HorizontalAlignment" Value="Center" />
            <Setter Property="Margin" Value="0,8" />
            <Setter Property="FontFamily" Value="Segoe UI, Arial" />
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1" />
                </Setter.Value>
            </Setter>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5" />
            <Style.Triggers>
                <EventTrigger RoutedEvent="Binding.TargetUpdated">
                    <BeginStoryboard>
                        <Storyboard>
                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                           From="1.1" To="1" Duration="0:0:0.3" />
                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                           From="1.1" To="1" Duration="0:0:0.3" />
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
                <!-- Smooth color transition when Foreground changes -->
                <Trigger Property="Foreground" Value="{x:Null}">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <ColorAnimation Storyboard.TargetProperty="(TextBlock.Foreground).(SolidColorBrush.Color)"
                                              Duration="0:0:0.5" />
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- Card Subtitle Style -->
        <Style x:Key="CardSubtitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11" />
            <Setter Property="Foreground" Value="{DynamicResource TertiaryText}" />
            <Setter Property="HorizontalAlignment" Value="Center" />
            <Setter Property="Margin" Value="0,8,0,0" />
        </Style>
        
        <!-- Progress Bar Style -->
        <Style x:Key="ModernProgressBar" TargetType="ProgressBar">
            <Setter Property="Height" Value="6" />
            <Setter Property="Background" Value="#E8ECEF" />
            <Setter Property="Foreground" Value="{StaticResource AccentColor}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ProgressBar">
                        <Grid>
                            <Border Background="{TemplateBinding Background}"
                                    CornerRadius="3" />
                            <Border Name="PART_Track"
                                    CornerRadius="3"
                                    ClipToBounds="True">
                                <Border Name="PART_Indicator"
                                        Background="{TemplateBinding Foreground}"
                                        HorizontalAlignment="Left"
                                        CornerRadius="3">
                                    <Border.Effect>
                                        <DropShadowEffect Color="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Foreground.Color}"
                                                        BlurRadius="8" ShadowDepth="0" Opacity="0.5" />
                                    </Border.Effect>
                                </Border>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Loading Spinner Style -->
        <Style x:Key="LoadingSpinner" TargetType="Border">
            <Setter Property="Width" Value="50" />
            <Setter Property="Height" Value="50" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5" />
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <RotateTransform Angle="0" />
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <EventTrigger RoutedEvent="Loaded">
                    <BeginStoryboard>
                        <Storyboard RepeatBehavior="Forever">
                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)"
                                           From="0" To="360" Duration="0:0:1.5" />
                        </Storyboard>
                    </BeginStoryboard>
                </EventTrigger>
            </Style.Triggers>
        </Style>
        
        <!-- Loading Overlay Style -->
        <Style x:Key="LoadingOverlay" TargetType="Grid">
            <Setter Property="Background" Value="#80000000" />
            <Setter Property="Visibility" Value="Collapsed" />
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsLoading}" Value="True">
                    <Setter Property="Visibility" Value="Visible" />
                    <DataTrigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                               From="0" To="1" Duration="0:0:0.2" />
                            </Storyboard>
                        </BeginStoryboard>
                    </DataTrigger.EnterActions>
                    <DataTrigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                               From="1" To="0" Duration="0:0:0.2" />
                            </Storyboard>
                        </BeginStoryboard>
                    </DataTrigger.ExitActions>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    
    <DockPanel>
        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_File">
                <MenuItem Header="_Export to CSV..." Command="{Binding ExportToCSVCommand}" />
                <Separator />
                <MenuItem Header="_Close" Click="Close_Click" />
            </MenuItem>
            <MenuItem Header="_View">
                <MenuItem Header="_Debug Window" Click="DebugWindow_Click" />
                <Separator />
                <MenuItem Header="Toggle _Theme" Click="ToggleTheme_Click">
                    <MenuItem.Icon>
                        <TextBlock Text="ðŸŒ“" FontSize="14" />
                    </MenuItem.Icon>
                </MenuItem>
            </MenuItem>
        </Menu>
        
        <!-- Main Content Area with ScrollViewer -->
        <ScrollViewer DockPanel.Dock="Top" 
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" MinHeight="200" />
                </Grid.RowDefinitions>
            
            <!-- Current Session Metrics Cards -->
            <UniformGrid Grid.Row="0" Rows="1" Columns="5" Margin="12,15,12,0">
                <!-- Smoothness Score Card -->
                <Border Style="{StaticResource MetricCardStyle}">
                    <Border.ToolTip>
                        <ToolTip ContentTemplate="{StaticResource MetricTooltipTemplate}"
                                 Content="{Binding SmoothnessTooltip}" />
                    </Border.ToolTip>
                    <StackPanel>
                        <!-- Icon -->
                        <TextBlock Text="ðŸŽ¯" Style="{StaticResource CardIconStyle}" />
                        
                        <!-- Title -->
                        <TextBlock Text="SMOOTHNESS" Style="{StaticResource CardTitleStyle}" />
                        
                        <!-- Value with RenderTransform for animation -->
                        <TextBlock Text="{Binding CurrentMetrics.SmoothnessScore, StringFormat={}{0:F0}%}" 
                                   Style="{StaticResource CardValueStyle}"
                                   Foreground="{Binding CurrentMetrics.OverallGrade, Converter={StaticResource GradeToColorConverter}}">
                            <TextBlock.RenderTransform>
                                <ScaleTransform ScaleX="1" ScaleY="1" />
                            </TextBlock.RenderTransform>
                        </TextBlock>
                        
                        <!-- Sparkline Chart -->
                        <Border x:Name="SmoothnessChartContainer"
                                Height="40"
                                Margin="0,5,0,5" />
                        
                        <!-- Subtitle -->
                        <TextBlock Text="Last 60 seconds" 
                                   Style="{StaticResource CardSubtitleStyle}" />
                    </StackPanel>
                </Border>
                
                <!-- Speed Compliance Card -->
                <Border Style="{StaticResource MetricCardStyle}">
                    <Border.ToolTip>
                        <ToolTip ContentTemplate="{StaticResource MetricTooltipTemplate}"
                                 Content="{Binding SpeedComplianceTooltip}" />
                    </Border.ToolTip>
                    <StackPanel>
                        <!-- Icon -->
                        <TextBlock Text="ðŸš¦" Style="{StaticResource CardIconStyle}" />
                        
                        <!-- Title -->
                        <TextBlock Text="SPEED COMPLIANCE" Style="{StaticResource CardTitleStyle}" />
                        
                        <!-- Value -->
                        <TextBlock Text="{Binding CurrentMetrics.SpeedCompliancePercent, StringFormat={}{0:F0}%}" 
                                   Style="{StaticResource CardValueStyle}"
                                   Foreground="{Binding CurrentMetrics.SpeedComplianceGrade, Converter={StaticResource GradeToColorConverter}}">
                            <TextBlock.RenderTransform>
                                <ScaleTransform ScaleX="1" ScaleY="1" />
                            </TextBlock.RenderTransform>
                        </TextBlock>
                        
                        <!-- Sparkline Chart -->
                        <Border x:Name="SpeedComplianceChartContainer"
                                Height="40"
                                Margin="0,5,0,5" />
                        
                        <!-- Subtitle with Grade -->
                        <TextBlock Style="{StaticResource CardSubtitleStyle}">
                            <Run Text="Grade: " />
                            <Run Text="{Binding CurrentMetrics.SpeedComplianceGrade, Mode=OneWay}" 
                                 FontWeight="Bold"
                                 Foreground="{Binding CurrentMetrics.SpeedComplianceGrade, Converter={StaticResource GradeToColorConverter}}" />
                        </TextBlock>
                    </StackPanel>
                </Border>
                
                <!-- Safety Score Card -->
                <Border Style="{StaticResource MetricCardStyle}">
                    <Border.ToolTip>
                        <ToolTip ContentTemplate="{StaticResource MetricTooltipTemplate}"
                                 Content="{Binding SafetyTooltip}" />
                    </Border.ToolTip>
                    <StackPanel>
                        <!-- Icon -->
                        <TextBlock Text="ðŸ›¡ï¸" Style="{StaticResource CardIconStyle}" />
                        
                        <!-- Title -->
                        <TextBlock Text="SAFETY" Style="{StaticResource CardTitleStyle}" />
                        
                        <!-- Value -->
                        <TextBlock Text="{Binding CurrentMetrics.SafetyScore, StringFormat={}{0:F0}%}" 
                                   Style="{StaticResource CardValueStyle}"
                                   Foreground="{Binding CurrentMetrics.OverallGrade, Converter={StaticResource GradeToColorConverter}}">
                            <TextBlock.RenderTransform>
                                <ScaleTransform ScaleX="1" ScaleY="1" />
                            </TextBlock.RenderTransform>
                        </TextBlock>
                        
                        <!-- Sparkline Chart -->
                        <Border x:Name="SafetyChartContainer"
                                Height="40"
                                Margin="0,5,0,5" />
                        
                        <!-- Subtitle -->
                        <TextBlock Text="Last 60 seconds" 
                                   Style="{StaticResource CardSubtitleStyle}" />
                    </StackPanel>
                </Border>
                
                <!-- Vehicle Damage Card -->
                <Border Style="{StaticResource MetricCardStyle}">
                    <StackPanel>
                        <!-- Icon -->
                        <TextBlock Text="ðŸ”§" Style="{StaticResource CardIconStyle}" />
                        
                        <!-- Title -->
                        <TextBlock Text="VEHICLE DAMAGE" Style="{StaticResource CardTitleStyle}" />
                        
                        <!-- Value -->
                        <TextBlock Text="{Binding CurrentDamage, StringFormat={}{0:F1}%}" 
                                   Style="{StaticResource CardValueStyle}"
                                   Foreground="{Binding CurrentDamage, Converter={StaticResource DamageToColorConverter}}">
                            <TextBlock.RenderTransform>
                                <ScaleTransform ScaleX="1" ScaleY="1" />
                            </TextBlock.RenderTransform>
                        </TextBlock>
                        
                        <!-- Sparkline Chart -->
                        <Border x:Name="DamageFreeChartContainer"
                                Height="40"
                                Margin="0,5,0,5" />
                        
                        <!-- Subtitle -->
                        <TextBlock Text="Current Damage" 
                                   Style="{StaticResource CardSubtitleStyle}" />
                    </StackPanel>
                </Border>
                
                <!-- Overall Score Card -->
                <Border Style="{StaticResource MetricCardStyle}">
                    <Border.ToolTip>
                        <ToolTip ContentTemplate="{StaticResource MetricTooltipTemplate}"
                                 Content="{Binding OverallTooltip}" />
                    </Border.ToolTip>
                    <StackPanel>
                        <!-- Icon -->
                        <TextBlock Text="âœ¨" Style="{StaticResource CardIconStyle}" />
                        
                        <!-- Title -->
                        <TextBlock Text="OVERALL SCORE" Style="{StaticResource CardTitleStyle}" />
                        
                        <!-- Value -->
                        <TextBlock Text="{Binding CurrentMetrics.OverallScore, StringFormat={}{0:F0}%}" 
                                   Style="{StaticResource CardValueStyle}"
                                   Foreground="{Binding CurrentMetrics.OverallGrade, Converter={StaticResource GradeToColorConverter}}">
                            <TextBlock.RenderTransform>
                                <ScaleTransform ScaleX="1" ScaleY="1" />
                            </TextBlock.RenderTransform>
                        </TextBlock>
                        
                        <!-- Sparkline Chart -->
                        <Border x:Name="OverallChartContainer"
                                Height="40"
                                Margin="0,5,0,5" />
                        
                        <!-- Subtitle -->
                        <TextBlock Text="Performance Trend" 
                                   Style="{StaticResource CardSubtitleStyle}" />
                    </StackPanel>
                </Border>
            </UniformGrid>
            
            <!-- Overall Grade Display -->
            <Border Grid.Row="1" Margin="12,0,12,10" Padding="30,25"
                    CornerRadius="12" BorderThickness="1"
                    Background="{DynamicResource CardBackground}"
                    BorderBrush="{DynamicResource CardBorderBrush}">
                <Border.Effect>
                    <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="3" 
                                      BlurRadius="15" Opacity="0.08" />
                </Border.Effect>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    
                    <!-- Overall Grade -->
                    <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                        <TextBlock Text="OVERALL PERFORMANCE" 
                                   FontSize="14" FontWeight="SemiBold" 
                                   Foreground="{DynamicResource SecondaryText}"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,15" />
                        
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <!-- Grade Badge -->
                            <Border Background="{Binding CurrentMetrics.OverallGrade, Converter={StaticResource GradeToColorConverter}}"
                                    CornerRadius="16" Padding="25,15" Margin="0,0,20,0">
                                <Border.Effect>
                                    <DropShadowEffect Color="{Binding RelativeSource={RelativeSource AncestorType=Border}, Path=Background.Color}"
                                                    BlurRadius="20" ShadowDepth="0" Opacity="0.4" />
                                </Border.Effect>
                                <TextBlock Text="{Binding CurrentMetrics.OverallGrade}" 
                                           FontSize="56" FontWeight="Black"
                                           Foreground="White"
                                           FontFamily="Segoe UI, Arial">
                                    <TextBlock.RenderTransform>
                                        <ScaleTransform ScaleX="1" ScaleY="1" />
                                    </TextBlock.RenderTransform>
                                </TextBlock>
                            </Border>
                            
                            <!-- Trend Indicator -->
                            <StackPanel VerticalAlignment="Center">
                                <Border Background="{Binding CurrentMetrics.Trend, Converter={StaticResource TrendToColorConverter}}"
                                        CornerRadius="8" Padding="12,8" Margin="0,0,0,8">
                                    <TextBlock Text="{Binding CurrentMetrics.Trend, Converter={StaticResource TrendToSymbolConverter}}" 
                                               FontSize="28" FontWeight="Bold"
                                               Foreground="White"
                                               HorizontalAlignment="Center" />
                                </Border>
                                <TextBlock Text="Trend" 
                                           FontSize="10" 
                                           Foreground="{DynamicResource TertiaryText}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                        </StackPanel>
                        
                        <!-- Score Details -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,20,0,0">
                            <Border Background="{DynamicResource CardBorderBrush}" CornerRadius="8" Padding="15,8">
                                <TextBlock FontSize="14" Foreground="{DynamicResource PrimaryText}">
                                    <Run Text="{Binding CurrentMetrics.OverallScore, StringFormat={}{0:F1}%, Mode=OneWay}" 
                                         FontWeight="Bold" />
                                    <Run Text="Overall Score" 
                                         Foreground="{DynamicResource SecondaryText}" />
                                </TextBlock>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Performance Breakdown Panel -->
            <Border Grid.Row="2" Style="{StaticResource MetricCardStyle}" 
                    Margin="12,0,12,10">
                <StackPanel>
                    <!-- Expandable Header -->
                    <Button Background="Transparent" BorderThickness="0" 
                            HorizontalContentAlignment="Stretch"
                            Padding="0"
                            Cursor="Hand"
                            Click="ToggleBreakdown_Click">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0" 
                                       Text="Score Breakdown" 
                                       FontSize="16" 
                                       FontWeight="SemiBold" 
                                       Foreground="#34495E"
                                       VerticalAlignment="Center" />
                            
                            <TextBlock Grid.Column="1" 
                                       Text="â–¼" 
                                       FontSize="14" 
                                       Foreground="#7F8C8D"
                                       VerticalAlignment="Center"
                                       Margin="10,0,0,0">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Text" Value="â–¼" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsBreakdownExpanded}" Value="True">
                                                <Setter Property="Text" Value="â–²" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </Button>
                    
                    <!-- Breakdown Content -->
                    <StackPanel Visibility="{Binding IsBreakdownExpanded, Converter={StaticResource BooleanToVisibilityConverter}}"
                                Margin="0,15,0,0">
                        
                        <!-- Smoothness Component -->
                        <Border BorderBrush="#ECF0F1" BorderThickness="0,1,0,0" Padding="0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" 
                                           Text="{Binding ScoreBreakdown.Smoothness.Icon}" 
                                           FontSize="24" 
                                           VerticalAlignment="Center"
                                           Margin="0,0,10,0" />
                                
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding ScoreBreakdown.Smoothness.Name}" 
                                               FontSize="14" 
                                               FontWeight="SemiBold"
                                               Foreground="#34495E" />
                                    <TextBlock Text="{Binding ScoreBreakdown.Smoothness.Description}" 
                                               FontSize="11" 
                                               Foreground="#7F8C8D"
                                               TextWrapping="Wrap" />
                                </StackPanel>
                                
                                <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                    <TextBlock FontSize="18" 
                                               FontWeight="Bold"
                                               HorizontalAlignment="Right"
                                               Foreground="{Binding ScoreBreakdown.Smoothness.ColorIndicator, Converter={StaticResource ColorIndicatorToBrushConverter}}">
                                        <Run Text="{Binding ScoreBreakdown.Smoothness.Value, StringFormat={}{0:F0}, Mode=OneWay}" />
                                        <Run Text="%" FontSize="12" />
                                    </TextBlock>
                                    <TextBlock Text="25% weight" 
                                               FontSize="10" 
                                               Foreground="#95A5A6"
                                               HorizontalAlignment="Right" />
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- Speed Compliance Component -->
                        <Border BorderBrush="#ECF0F1" BorderThickness="0,1,0,0" Padding="0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" 
                                           Text="{Binding ScoreBreakdown.SpeedCompliance.Icon}" 
                                           FontSize="24" 
                                           VerticalAlignment="Center"
                                           Margin="0,0,10,0" />
                                
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding ScoreBreakdown.SpeedCompliance.Name}" 
                                               FontSize="14" 
                                               FontWeight="SemiBold"
                                               Foreground="#34495E" />
                                    <TextBlock Text="{Binding ScoreBreakdown.SpeedCompliance.Description}" 
                                               FontSize="11" 
                                               Foreground="#7F8C8D"
                                               TextWrapping="Wrap" />
                                </StackPanel>
                                
                                <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                    <TextBlock FontSize="18" 
                                               FontWeight="Bold"
                                               HorizontalAlignment="Right"
                                               Foreground="{Binding ScoreBreakdown.SpeedCompliance.ColorIndicator, Converter={StaticResource ColorIndicatorToBrushConverter}}">
                                        <Run Text="{Binding ScoreBreakdown.SpeedCompliance.Value, StringFormat={}{0:F0}, Mode=OneWay}" />
                                        <Run Text="%" FontSize="12" />
                                    </TextBlock>
                                    <TextBlock Text="25% weight" 
                                               FontSize="10" 
                                               Foreground="#95A5A6"
                                               HorizontalAlignment="Right" />
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- Safety Component -->
                        <Border BorderBrush="#ECF0F1" BorderThickness="0,1,0,0" Padding="0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" 
                                           Text="{Binding ScoreBreakdown.Safety.Icon}" 
                                           FontSize="24" 
                                           VerticalAlignment="Center"
                                           Margin="0,0,10,0" />
                                
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding ScoreBreakdown.Safety.Name}" 
                                               FontSize="14" 
                                               FontWeight="SemiBold"
                                               Foreground="#34495E" />
                                    <TextBlock Text="{Binding ScoreBreakdown.Safety.Description}" 
                                               FontSize="11" 
                                               Foreground="#7F8C8D"
                                               TextWrapping="Wrap" />
                                </StackPanel>
                                
                                <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                    <TextBlock FontSize="18" 
                                               FontWeight="Bold"
                                               HorizontalAlignment="Right"
                                               Foreground="{Binding ScoreBreakdown.Safety.ColorIndicator, Converter={StaticResource ColorIndicatorToBrushConverter}}">
                                        <Run Text="{Binding ScoreBreakdown.Safety.Value, StringFormat={}{0:F0}, Mode=OneWay}" />
                                        <Run Text="%" FontSize="12" />
                                    </TextBlock>
                                    <TextBlock Text="25% weight" 
                                               FontSize="10" 
                                               Foreground="#95A5A6"
                                               HorizontalAlignment="Right" />
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- Damage-Free Component -->
                        <Border BorderBrush="#ECF0F1" BorderThickness="0,1,0,0" Padding="0,10">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" 
                                           Text="{Binding ScoreBreakdown.DamageFree.Icon}" 
                                           FontSize="24" 
                                           VerticalAlignment="Center"
                                           Margin="0,0,10,0" />
                                
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding ScoreBreakdown.DamageFree.Name}" 
                                               FontSize="14" 
                                               FontWeight="SemiBold"
                                               Foreground="#34495E" />
                                    <TextBlock Text="{Binding ScoreBreakdown.DamageFree.Description}" 
                                               FontSize="11" 
                                               Foreground="#7F8C8D"
                                               TextWrapping="Wrap" />
                                </StackPanel>
                                
                                <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                                    <TextBlock FontSize="18" 
                                               FontWeight="Bold"
                                               HorizontalAlignment="Right"
                                               Foreground="{Binding ScoreBreakdown.DamageFree.ColorIndicator, Converter={StaticResource ColorIndicatorToBrushConverter}}">
                                        <Run Text="{Binding ScoreBreakdown.DamageFree.Value, StringFormat={}{0:F0}, Mode=OneWay}" />
                                        <Run Text="%" FontSize="12" />
                                    </TextBlock>
                                    <TextBlock Text="25% weight" 
                                               FontSize="10" 
                                               Foreground="#95A5A6"
                                               HorizontalAlignment="Right" />
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                    </StackPanel>
                </StackPanel>
            </Border>
            
            <!-- Live Performance Events Panel - Enhanced Scrollable Log -->
            <Border Grid.Row="3" Style="{StaticResource MetricCardStyle}" 
                    Margin="12,0,12,10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    
                    <!-- Header with Event Count -->
                    <Grid Grid.Row="0" Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" Orientation="Horizontal">
                            <TextBlock Text="ðŸ“‹" 
                                       FontSize="18" 
                                       VerticalAlignment="Center"
                                       Margin="0,0,8,0" />
                            <TextBlock Text="Live Performance Events" 
                                       FontSize="16" 
                                       FontWeight="SemiBold" 
                                       Foreground="#34495E"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                        
                        <!-- Event Counter Badge -->
                        <Border Grid.Column="1" 
                                Background="#3498DB"
                                CornerRadius="12"
                                Padding="10,4"
                                VerticalAlignment="Center">
                            <TextBlock FontSize="11" 
                                       FontWeight="Bold"
                                       Foreground="White">
                                <Run Text="{Binding RecentNotifications.Count, Mode=OneWay}" />
                                <Run Text=" Events" />
                            </TextBlock>
                        </Border>
                    </Grid>
                    
                    <!-- Subtitle -->
                    <TextBlock Grid.Row="1" 
                               Text="Persistent event log for this session â€¢ Scroll to view history"
                               FontSize="11" 
                               Foreground="#7F8C8D"
                               Margin="0,0,0,12" />
                    
                    <!-- Scrollable Events Container -->
                    <Border Grid.Row="2" 
                            Background="#F8F9FA"
                            BorderBrush="#E8ECEF"
                            BorderThickness="1"
                            CornerRadius="8"
                            Height="220">
                        <ScrollViewer VerticalScrollBarVisibility="Auto"
                                      HorizontalScrollBarVisibility="Disabled"
                                      Padding="8">
                            <Grid>
                                <!-- Events List -->
                                <ItemsControl ItemsSource="{Binding RecentNotifications}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="White"
                                                    BorderBrush="#E8ECEF" 
                                                    BorderThickness="0,0,0,1" 
                                                    Padding="12,10"
                                                    Margin="0,0,0,6"
                                                    CornerRadius="6"
                                                    Opacity="0">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Setter Property="Effect">
                                                            <Setter.Value>
                                                                <DropShadowEffect Color="#000000" 
                                                                                Direction="270" 
                                                                                ShadowDepth="1" 
                                                                                BlurRadius="4" 
                                                                                Opacity="0.05" />
                                                            </Setter.Value>
                                                        </Setter>
                                                        <Style.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#F0F3F7" />
                                                                <Setter Property="Effect">
                                                                    <Setter.Value>
                                                                        <DropShadowEffect Color="#000000" 
                                                                                        Direction="270" 
                                                                                        ShadowDepth="2" 
                                                                                        BlurRadius="8" 
                                                                                        Opacity="0.1" />
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </Trigger>
                                                            <EventTrigger RoutedEvent="Loaded">
                                                                <BeginStoryboard>
                                                                    <Storyboard>
                                                                        <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                                                       From="0" To="1" 
                                                                                       Duration="0:0:0.4"
                                                                                       AccelerationRatio="0.2" />
                                                                    </Storyboard>
                                                                </BeginStoryboard>
                                                            </EventTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>
                                                    
                                                    <!-- Top Row: Icon, Message, Category -->
                                                    <Grid Grid.Row="0">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="Auto" />
                                                        </Grid.ColumnDefinitions>
                                                        
                                                        <!-- Event Type Indicator -->
                                                        <Border Grid.Column="0" 
                                                                Width="24" Height="24"
                                                                CornerRadius="12"
                                                                Margin="0,0,12,0"
                                                                VerticalAlignment="Top"
                                                                Background="{Binding Type, Converter={StaticResource NotificationTypeToColorConverter}}">
                                                            <Border.Effect>
                                                                <DropShadowEffect Color="{Binding RelativeSource={RelativeSource AncestorType=Border}, Path=Background.Color}"
                                                                                BlurRadius="8" 
                                                                                ShadowDepth="0" 
                                                                                Opacity="0.4" />
                                                            </Border.Effect>
                                                            <TextBlock Text="â—" 
                                                                       FontSize="14" 
                                                                       FontWeight="Bold"
                                                                       Foreground="White"
                                                                       HorizontalAlignment="Center"
                                                                       VerticalAlignment="Center" />
                                                        </Border>
                                                        
                                                        <!-- Message Text -->
                                                        <TextBlock Grid.Column="1" 
                                                                   Text="{Binding Message}" 
                                                                   FontSize="12"
                                                                   FontWeight="Medium"
                                                                   VerticalAlignment="Center"
                                                                   TextWrapping="Wrap"
                                                                   Foreground="#2C3E50"
                                                                   LineHeight="18" />
                                                        
                                                        <!-- Category Badge -->
                                                        <Border Grid.Column="2" 
                                                                Background="{Binding Type, Converter={StaticResource NotificationTypeToColorConverter}}"
                                                                CornerRadius="4"
                                                                Padding="8,3"
                                                                Margin="12,0,0,0"
                                                                VerticalAlignment="Center"
                                                                Opacity="0.15">
                                                            <TextBlock Text="{Binding Category}" 
                                                                       FontSize="10"
                                                                       FontWeight="SemiBold"
                                                                       Foreground="{Binding Type, Converter={StaticResource NotificationTypeToColorConverter}}" />
                                                        </Border>
                                                    </Grid>
                                                    
                                                    <!-- Bottom Row: Timestamp -->
                                                    <StackPanel Grid.Row="1" 
                                                               Orientation="Horizontal"
                                                               Margin="36,6,0,0">
                                                        <TextBlock Text="ðŸ•" 
                                                                   FontSize="10" 
                                                                   Foreground="#95A5A6"
                                                                   Margin="0,0,4,0"
                                                                   VerticalAlignment="Center" />
                                                        <TextBlock Text="{Binding Timestamp, StringFormat='{}{0:HH:mm:ss}'}" 
                                                                   FontSize="10"
                                                                   Foreground="#95A5A6"
                                                                   VerticalAlignment="Center" />
                                                        <TextBlock Text=" â€¢ " 
                                                                   FontSize="10" 
                                                                   Foreground="#BDC3C7"
                                                                   Margin="4,0"
                                                                   VerticalAlignment="Center" />
                                                        <TextBlock FontSize="10"
                                                                   Foreground="#95A5A6"
                                                                   VerticalAlignment="Center">
                                                            <Run Text="{Binding Timestamp, StringFormat='{}{0:MMM dd, yyyy}', Mode=OneWay}" />
                                                        </TextBlock>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                                
                                <!-- Empty State (shown when no notifications) -->
                                <StackPanel Margin="0,40,0,0"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center">
                                    <StackPanel.Style>
                                        <Style TargetType="StackPanel">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RecentNotifications.Count}" Value="0">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </StackPanel.Style>
                                    
                                    <TextBlock Text="ðŸ“­" 
                                               FontSize="48" 
                                               HorizontalAlignment="Center"
                                               Opacity="0.3"
                                               Margin="0,0,0,15" />
                                    <TextBlock Text="No events yet" 
                                               FontSize="14" 
                                               FontWeight="SemiBold"
                                               Foreground="#7F8C8D"
                                               HorizontalAlignment="Center" />
                                    <TextBlock Text="Start driving to see real-time performance feedback" 
                                               FontSize="11" 
                                               Foreground="#95A5A6"
                                               HorizontalAlignment="Center"
                                               Margin="0,5,0,0" />
                                </StackPanel>
                            </Grid>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </Border>
            
            <!-- Performance Trend Chart Section -->
            <Border Grid.Row="4" Style="{StaticResource MetricCardStyle}" 
                    Margin="12,0,12,10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    
                    <!-- Performance Trend Chart -->
                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                        <TextBlock Text="ðŸ“ˆ Performance Trend" 
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   Foreground="{DynamicResource PrimaryText}"
                                   Margin="0,0,0,15" />
                        
                        <TextBlock Text="Overall grade for your last 10 trips" 
                                   FontSize="12" 
                                   Foreground="{DynamicResource SecondaryText}"
                                   Margin="0,0,0,10" />
                        
                        <!-- Trend Line Chart -->
                        <Border x:Name="PerformanceTrendChart"
                                Height="250"
                                Margin="0,10,0,0" />
                        
                        <!-- Legend -->
                        <StackPanel Orientation="Horizontal" 
                                    HorizontalAlignment="Center"
                                    Margin="0,15,0,0">
                            <Border Background="#27AE60" 
                                    Width="12" Height="12" 
                                    CornerRadius="2"
                                    Margin="0,0,5,0"
                                    VerticalAlignment="Center" />
                            <TextBlock Text="A (90-100%)" 
                                       FontSize="11" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       Margin="0,0,15,0"
                                       VerticalAlignment="Center" />
                            
                            <Border Background="#3498DB" 
                                    Width="12" Height="12" 
                                    CornerRadius="2"
                                    Margin="0,0,5,0"
                                    VerticalAlignment="Center" />
                            <TextBlock Text="B (80-89%)" 
                                       FontSize="11" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       Margin="0,0,15,0"
                                       VerticalAlignment="Center" />
                            
                            <Border Background="#F39C12" 
                                    Width="12" Height="12" 
                                    CornerRadius="2"
                                    Margin="0,0,5,0"
                                    VerticalAlignment="Center" />
                            <TextBlock Text="C (70-79%)" 
                                       FontSize="11" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       Margin="0,0,15,0"
                                       VerticalAlignment="Center" />
                            
                            <Border Background="#E74C3C" 
                                    Width="12" Height="12" 
                                    CornerRadius="2"
                                    Margin="0,0,5,0"
                                    VerticalAlignment="Center" />
                            <TextBlock Text="D/F (&lt;70%)" 
                                       FontSize="11" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Comparison Bar Chart -->
                    <StackPanel Grid.Column="1" Margin="10,0,0,0">
                        <TextBlock Text="ðŸ“Š Current vs Average" 
                                   FontSize="18" 
                                   FontWeight="Bold" 
                                   Foreground="{DynamicResource PrimaryText}"
                                   Margin="0,0,0,15" />
                        
                        <TextBlock Text="How you're performing compared to your personal averages" 
                                   FontSize="12" 
                                   Foreground="{DynamicResource SecondaryText}"
                                   Margin="0,0,0,10" />
                        
                        <!-- Comparison Bar Chart -->
                        <Border x:Name="ComparisonChart"
                                Height="250"
                                Margin="0,10,0,0" />
                        
                        <!-- Legend -->
                        <StackPanel Orientation="Horizontal" 
                                    HorizontalAlignment="Center"
                                    Margin="0,15,0,0">
                            <Border Background="#27AE60" 
                                    Width="12" Height="12" 
                                    CornerRadius="2"
                                    Margin="0,0,5,0"
                                    VerticalAlignment="Center" />
                            <TextBlock Text="Above Average" 
                                       FontSize="11" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       Margin="0,0,15,0"
                                       VerticalAlignment="Center" />
                            
                            <Border Background="#E74C3C" 
                                    Width="12" Height="12" 
                                    CornerRadius="2"
                                    Margin="0,0,5,0"
                                    VerticalAlignment="Center" />
                            <TextBlock Text="Below Average" 
                                       FontSize="11" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       Margin="0,0,15,0"
                                       VerticalAlignment="Center" />
                            
                            <Border Background="#95A5A6" 
                                    Width="12" Height="12" 
                                    CornerRadius="2"
                                    Margin="0,0,5,0"
                                    VerticalAlignment="Center" />
                            <TextBlock Text="Personal Average" 
                                       FontSize="11" 
                                       Foreground="{DynamicResource SecondaryText}"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Trip History Section -->
            <Border Grid.Row="5" Style="{StaticResource MetricCardStyle}" 
                    Margin="12,0,12,10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    
                    <!-- Header -->
                    <TextBlock Grid.Row="0" 
                               Text="Trip History" 
                               FontSize="18" 
                               FontWeight="Bold" 
                               Foreground="{DynamicResource PrimaryText}"
                               Margin="0,0,0,15" />
                    
                    <!-- Summary Statistics -->
                    <Border Grid.Row="1" 
                            Background="{DynamicResource CardBorderBrush}"
                            CornerRadius="8"
                            Padding="15"
                            Margin="0,0,0,15">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            
                            <!-- Total Trips -->
                            <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ“Š" 
                                           FontSize="24" 
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,5" />
                                <TextBlock Text="{Binding Statistics.TotalTrips}" 
                                           FontSize="20" 
                                           FontWeight="Bold"
                                           Foreground="{DynamicResource PrimaryText}"
                                           HorizontalAlignment="Center" />
                                <TextBlock Text="Total Trips" 
                                           FontSize="11" 
                                           Foreground="{DynamicResource SecondaryText}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                            
                            <!-- Average Grade -->
                            <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                <TextBlock Text="ðŸŽ“" 
                                           FontSize="24" 
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,5" />
                                <TextBlock FontSize="20" 
                                           FontWeight="Bold"
                                           HorizontalAlignment="Center"
                                           Foreground="{Binding Statistics.AverageOverallScore, Converter={StaticResource ScoreToColorConverter}}">
                                    <Run Text="{Binding Statistics.AverageOverallScore, StringFormat={}{0:F0}, Mode=OneWay}" />
                                    <Run Text="%" FontSize="14" />
                                </TextBlock>
                                <TextBlock Text="Avg Score" 
                                           FontSize="11" 
                                           Foreground="{DynamicResource SecondaryText}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                            
                            <!-- Best Grade -->
                            <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ†" 
                                           FontSize="24" 
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,5" />
                                <TextBlock Text="{Binding Statistics.BestGrade}" 
                                           FontSize="20" 
                                           FontWeight="Bold"
                                           Foreground="{Binding Statistics.BestGrade, Converter={StaticResource GradeToColorConverter}}"
                                           HorizontalAlignment="Center" />
                                <TextBlock Text="Best Grade" 
                                           FontSize="11" 
                                           Foreground="{DynamicResource SecondaryText}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                            
                            <!-- Total Distance -->
                            <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ›£ï¸" 
                                           FontSize="24" 
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,5" />
                                <TextBlock FontSize="20" 
                                           FontWeight="Bold"
                                           Foreground="{DynamicResource PrimaryText}"
                                           HorizontalAlignment="Center">
                                    <Run Text="{Binding Statistics.TotalDistanceMiles, StringFormat={}{0:F0}, Mode=OneWay}" />
                                </TextBlock>
                                <TextBlock Text="Total Miles" 
                                           FontSize="11" 
                                           Foreground="{DynamicResource SecondaryText}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                            
                            <!-- Average MPG -->
                            <StackPanel Grid.Column="4" HorizontalAlignment="Center">
                                <TextBlock Text="â›½" 
                                           FontSize="24" 
                                           HorizontalAlignment="Center"
                                           Margin="0,0,0,5" />
                                <TextBlock FontSize="20" 
                                           FontWeight="Bold"
                                           Foreground="{DynamicResource PrimaryText}"
                                           HorizontalAlignment="Center">
                                    <Run Text="{Binding Statistics.AverageFuelEfficiencyMPG, StringFormat={}{0:F1}, Mode=OneWay}" />
                                </TextBlock>
                                <TextBlock Text="Avg MPG" 
                                           FontSize="11" 
                                           Foreground="{DynamicResource SecondaryText}"
                                           HorizontalAlignment="Center" />
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- Date Range Filter -->
                    <Border Grid.Row="2" 
                            Background="{DynamicResource CardBorderBrush}"
                            CornerRadius="8"
                            Padding="12"
                            Margin="0,0,0,15">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0" 
                                       Text="ðŸ“… Filter:" 
                                       FontSize="13"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource PrimaryText}"
                                       VerticalAlignment="Center"
                                       Margin="0,0,10,0" />
                            
                            <TextBlock Grid.Column="1" 
                                       Text="From:" 
                                       FontSize="12"
                                       Foreground="{DynamicResource SecondaryText}"
                                       VerticalAlignment="Center"
                                       Margin="0,0,5,0" />
                            
                            <DatePicker Grid.Column="2" 
                                        SelectedDate="{Binding FilterStartDate, Mode=TwoWay}"
                                        Margin="0,0,10,0"
                                        VerticalAlignment="Center" />
                            
                            <TextBlock Grid.Column="3" 
                                       Text="To:" 
                                       FontSize="12"
                                       Foreground="{DynamicResource SecondaryText}"
                                       VerticalAlignment="Center"
                                       Margin="0,0,5,0" />
                            
                            <DatePicker Grid.Column="4" 
                                        SelectedDate="{Binding FilterEndDate, Mode=TwoWay}"
                                        Margin="0,0,10,0"
                                        VerticalAlignment="Center" />
                            
                            <Button Grid.Column="5" 
                                    Content="Apply Filter"
                                    Command="{Binding FilterByDateCommand}"
                                    Padding="15,5"
                                    Background="{DynamicResource AccentColor}"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    FontSize="12"
                                    FontWeight="SemiBold">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                            CornerRadius="5"
                                                            Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center" />
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Opacity" Value="0.9" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </Grid>
                    </Border>
                    
                    <!-- Recent Trips List -->
                    <ListView Grid.Row="3" 
                              ItemsSource="{Binding RecentTrips}"
                              BorderThickness="0"
                              Background="Transparent"
                              ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                <Setter Property="Padding" Value="0" />
                                <Setter Property="Margin" Value="0,0,0,8" />
                                <Setter Property="RenderTransform">
                                    <Setter.Value>
                                        <TranslateTransform X="0" />
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListViewItem">
                                            <Border x:Name="ItemBorder"
                                                    Background="{TemplateBinding Background}"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    CornerRadius="8"
                                                    Padding="15">
                                                <Border.Effect>
                                                    <DropShadowEffect x:Name="ItemShadow"
                                                                    Color="#000000" 
                                                                    Direction="270" 
                                                                    ShadowDepth="2" 
                                                                    BlurRadius="8" 
                                                                    Opacity="0.05" />
                                                </Border.Effect>
                                                <ContentPresenter />
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Trigger.EnterActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation Storyboard.TargetName="ItemShadow"
                                                                               Storyboard.TargetProperty="ShadowDepth"
                                                                               To="4" Duration="0:0:0.2" />
                                                                <DoubleAnimation Storyboard.TargetName="ItemShadow"
                                                                               Storyboard.TargetProperty="BlurRadius"
                                                                               To="15" Duration="0:0:0.2" />
                                                                <DoubleAnimation Storyboard.TargetName="ItemShadow"
                                                                               Storyboard.TargetProperty="Opacity"
                                                                               To="0.12" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.EnterActions>
                                                    <Trigger.ExitActions>
                                                        <BeginStoryboard>
                                                            <Storyboard>
                                                                <DoubleAnimation Storyboard.TargetName="ItemShadow"
                                                                               Storyboard.TargetProperty="ShadowDepth"
                                                                               To="2" Duration="0:0:0.2" />
                                                                <DoubleAnimation Storyboard.TargetName="ItemShadow"
                                                                               Storyboard.TargetProperty="BlurRadius"
                                                                               To="8" Duration="0:0:0.2" />
                                                                <DoubleAnimation Storyboard.TargetName="ItemShadow"
                                                                               Storyboard.TargetProperty="Opacity"
                                                                               To="0.05" Duration="0:0:0.2" />
                                                            </Storyboard>
                                                        </BeginStoryboard>
                                                    </Trigger.ExitActions>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="Background" Value="{DynamicResource CardBorderBrush}" />
                                <Setter Property="BorderThickness" Value="0" />
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#E0E6ED" />
                                        <Trigger.EnterActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                                                                   To="5" Duration="0:0:0.2" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.EnterActions>
                                        <Trigger.ExitActions>
                                            <BeginStoryboard>
                                                <Storyboard>
                                                    <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                                                                   To="0" Duration="0:0:0.2" />
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </Trigger.ExitActions>
                                    </Trigger>
                                    <EventTrigger RoutedEvent="Loaded">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                               From="0" To="1" Duration="0:0:0.4" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.ItemContainerStyle>
                        
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- Trip Number Icon -->
                                    <Border Grid.Column="0" 
                                            Background="{DynamicResource AccentColor}"
                                            CornerRadius="6"
                                            Width="40"
                                            Height="40"
                                            Margin="0,0,15,0">
                                        <TextBlock Text="{Binding Id}" 
                                                   FontSize="16" 
                                                   FontWeight="Bold"
                                                   Foreground="White"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center" />
                                    </Border>
                                    
                                    <!-- Trip Details -->
                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                        <TextBlock FontSize="13" 
                                                   FontWeight="SemiBold"
                                                   Foreground="{DynamicResource PrimaryText}">
                                            <Run Text="ðŸ•" />
                                            <Run Text="{Binding StartTime, StringFormat='{}{0:MMM dd, yyyy - h:mm tt}', Mode=OneWay}" />
                                        </TextBlock>
                                        <TextBlock FontSize="11" 
                                                   Foreground="{DynamicResource SecondaryText}"
                                                   Margin="0,3,0,0">
                                            <Run Text="Duration:" />
                                            <Run Text="{Binding DurationMinutes, StringFormat='{}{0:F0} min', Mode=OneWay}" FontWeight="SemiBold" />
                                            <Run Text=" | Distance:" />
                                            <Run Text="{Binding DistanceMiles, StringFormat='{}{0:F1} mi', Mode=OneWay}" FontWeight="SemiBold" />
                                        </TextBlock>
                                    </StackPanel>
                                    
                                    <!-- Smoothness Score -->
                                    <StackPanel Grid.Column="2" 
                                                VerticalAlignment="Center"
                                                Margin="15,0">
                                        <TextBlock Text="ðŸŽ¯" 
                                                   FontSize="16" 
                                                   HorizontalAlignment="Center" />
                                        <TextBlock FontSize="12" 
                                                   FontWeight="Bold"
                                                   HorizontalAlignment="Center"
                                                   Foreground="{Binding OverallGrade, Converter={StaticResource GradeToColorConverter}}">
                                            <Run Text="{Binding SmoothnessScore, StringFormat='{}{0:F0}%', Mode=OneWay}" />
                                        </TextBlock>
                                    </StackPanel>
                                    
                                    <!-- Speed Compliance -->
                                    <StackPanel Grid.Column="3" 
                                                VerticalAlignment="Center"
                                                Margin="15,0">
                                        <TextBlock Text="ðŸš¦" 
                                                   FontSize="16" 
                                                   HorizontalAlignment="Center" />
                                        <TextBlock FontSize="12" 
                                                   FontWeight="Bold"
                                                   HorizontalAlignment="Center"
                                                   Foreground="{Binding OverallGrade, Converter={StaticResource GradeToColorConverter}}">
                                            <Run Text="{Binding SpeedCompliancePercent, StringFormat='{}{0:F0}%', Mode=OneWay}" />
                                        </TextBlock>
                                    </StackPanel>
                                    
                                    <!-- Safety Score -->
                                    <StackPanel Grid.Column="4" 
                                                VerticalAlignment="Center"
                                                Margin="15,0">
                                        <TextBlock Text="ðŸ›¡ï¸" 
                                                   FontSize="16" 
                                                   HorizontalAlignment="Center" />
                                        <TextBlock FontSize="12" 
                                                   FontWeight="Bold"
                                                   HorizontalAlignment="Center"
                                                   Foreground="{Binding OverallGrade, Converter={StaticResource GradeToColorConverter}}">
                                            <Run Text="{Binding SafetyScore, StringFormat='{}{0:F0}%', Mode=OneWay}" />
                                        </TextBlock>
                                    </StackPanel>
                                    
                                    <!-- MPG -->
                                    <StackPanel Grid.Column="5" 
                                                VerticalAlignment="Center"
                                                Margin="15,0">
                                        <TextBlock Text="â›½" 
                                                   FontSize="16" 
                                                   HorizontalAlignment="Center" />
                                        <TextBlock FontSize="12" 
                                                   FontWeight="Bold"
                                                   HorizontalAlignment="Center"
                                                   Foreground="{DynamicResource PrimaryText}">
                                            <Run Text="{Binding FuelEfficiencyMPG, StringFormat='{}{0:F1}', Mode=OneWay}" />
                                        </TextBlock>
                                    </StackPanel>
                                    
                                    <!-- Overall Grade Badge -->
                                    <Border Grid.Column="6" 
                                            Background="{Binding OverallGrade, Converter={StaticResource GradeToColorConverter}}"
                                            CornerRadius="8"
                                            Padding="15,8"
                                            Margin="15,0,0,0"
                                            VerticalAlignment="Center">
                                        <TextBlock Text="{Binding OverallGrade}" 
                                                   FontSize="18" 
                                                   FontWeight="Black"
                                                   Foreground="White" />
                                    </Border>
                                </Grid>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                        
                        <!-- Empty State -->
                        <ListView.Style>
                            <Style TargetType="ListView">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding RecentTrips.Count}" Value="0">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <Border Background="Transparent"
                                                            Padding="30">
                                                        <StackPanel HorizontalAlignment="Center"
                                                                   VerticalAlignment="Center">
                                                            <TextBlock Text="ðŸš›" 
                                                                       FontSize="48" 
                                                                       HorizontalAlignment="Center"
                                                                       Opacity="0.3"
                                                                       Margin="0,0,0,15" />
                                                            <TextBlock Text="No trips recorded yet" 
                                                                       FontSize="16" 
                                                                       FontWeight="SemiBold"
                                                                       Foreground="{DynamicResource SecondaryText}"
                                                                       HorizontalAlignment="Center" />
                                                            <TextBlock Text="Complete a trip to see it appear here" 
                                                                       FontSize="12" 
                                                                       Foreground="{DynamicResource TertiaryText}"
                                                                       HorizontalAlignment="Center"
                                                                       Margin="0,5,0,0" />
                                                        </StackPanel>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </ListView.Style>
                    </ListView>
                </Grid>
            </Border>
            
            <!-- Loading Overlay -->
            <Grid Grid.Row="0" Grid.RowSpan="6" 
                  Style="{StaticResource LoadingOverlay}"
                  Panel.ZIndex="1000">
                <Border Background="#FFFFFF" 
                        CornerRadius="12"
                        Padding="30"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center">
                    <Border.Effect>
                        <DropShadowEffect Color="#000000" Direction="270" ShadowDepth="5" 
                                          BlurRadius="30" Opacity="0.3" />
                    </Border.Effect>
                    <StackPanel>
                        <!-- Spinning loader -->
                        <Border Style="{StaticResource LoadingSpinner}"
                                HorizontalAlignment="Center">
                            <Ellipse Width="50" Height="50" 
                                     StrokeThickness="4"
                                     Stroke="{StaticResource AccentColor}"
                                     StrokeDashArray="8 4"
                                     StrokeDashCap="Round" />
                        </Border>
                        
                        <!-- Loading text -->
                        <TextBlock Text="{Binding LoadingMessage, FallbackValue='Loading...'}" 
                                   FontSize="14"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource PrimaryText}"
                                   HorizontalAlignment="Center"
                                   Margin="0,15,0,0" />
                    </StackPanel>
                </Border>
            </Grid>
            </Grid>
        </ScrollViewer>
        
        <!-- Status Bar -->
        <StatusBar DockPanel.Dock="Bottom" Height="25">
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>
            
            <!-- Connection Status -->
            <StatusBarItem Grid.Column="0">
                <StackPanel Orientation="Horizontal">
                    <Ellipse Width="10" Height="10" Margin="5,0"
                             Fill="{Binding ConnectionStatus, Converter={StaticResource ConnectionStatusToColorConverter}}" />
                    <TextBlock Text="{Binding ConnectionStatus}" Margin="5,0" />
                </StackPanel>
            </StatusBarItem>
            
            <!-- Spacer -->
            <StatusBarItem Grid.Column="1" />
            
            <!-- Current Speed and Distance -->
            <StatusBarItem Grid.Column="2">
                <StackPanel Orientation="Horizontal" Margin="10,0">
                    <TextBlock Text="Speed: " />
                    <TextBlock Text="{Binding CurrentSpeed, StringFormat={}{0:F0}}" />
                    <TextBlock Text=" MPH | Distance: " />
                    <TextBlock Text="{Binding CurrentMetrics.SessionDistanceMiles, StringFormat={}{0:F2}}" />
                    <TextBlock Text=" mi" />
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </DockPanel>
</Window>
